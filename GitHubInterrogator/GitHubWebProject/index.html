<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Product App</title>
</head>
<body>

    <svg class="line-chart"></svg>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="index.js"></script>

    <div>
        <h2>All Products</h2>
        <ul id="products" />
    </div>
    <div>
        <h2>Search by ID</h2>
        <input type="text" id="prodId" size="30" />
        <input type="button" value="Search" onclick="find();" />
        <p id="product" />
    </div>

    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.0.3.min.js"></script>
    <script>
        var uri = 'api/issues';
        var setup = uri + '/setup';

        $(document).ready(function () {
            //// Send an AJAX request
            //$.ajax({
            //    type: 'POST',
            //    url: setup
            //});
            ////.done(function (data) {
            ////    // On success, 'data' contains a list of products.
            ////    $.each(data, function (key, item) {
            ////        // Add a list item for the product.
            ////        $('<li>', { text: formatItem(item) }).appendTo($('#products'));
            ////    });
            ////});
        });

        function formatItem(item) {
            return item.Number + ': ' + item.CreatedAt;
        }

        function find() {
            var id = $('#prodId').val();
            $.ajax({
                type: 'GET',
                url: uri + '/url',
                async: true,
                data: {
                    repoUrl: id
                },
                success: function (data) {
                    var parsedData = parseData(data);
                    drawChart(parsedData);
                    //$.each(data, function (key, item) {
                    //    $('<li>', { text: formatItem(item) }).appendTo($('#products'));
                    //});
                },
                fail: function (xhr) {
                    $('#product').text('Error: ');
                }
            });
        }

                                                                                                    //$.getJSON(uri + '/' + id)
                                                                                                    //    .done(function (data) {
                                                                                                    //        $.each(data, function (key, item) {
                                                                                                    //            $('<li>', { text: formatItem(item) }).appendTo($('#products'));
                                                                                                    //        });
                                                                                                    //    })
                                                                                                    //    .fail(function (jqXHR, textStatus, err) {
                                                                                                    //        $('#product').text('Error: ' + err);
                                                                                                    //    });
                                                                                                    //    }

                                                                                                                        //var id = $('#prodId').val();
                                                                                                                        //$.getJSON(uri + '/' + id)
                                                                                                                        //    .done(function (data) {
                                                                                                                        //        $.each(data, function (key, item) {
                                                                                                                        //            $('<li>', { text: formatItem(item) }).appendTo($('#products'));
                                                                                                                        //        }
                                                                                                                        //            .fail(function (jqXHR, textStatus, err) {
                                                                                                                        //                $('#product').text('Error: ' + err);
                                                                                                                        //            });
                                                                                                                        //    }
    </script>
</body>
</html>